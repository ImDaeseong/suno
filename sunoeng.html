<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Suno AI Prompt Builder</title>
    <style>
        /* Base Styles */
        body { font-family: 'Segoe UI', Arial, sans-serif; padding: 20px; background-color: #f4f4f9; color: #333; }
        section { margin-bottom: 25px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; background-color: white; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        h1 { color: #007bff; text-align: center; margin-bottom: 30px; }
        h2 { color: #333; border-bottom: 2px solid #007bff; padding-bottom: 5px; margin-top: 0; }
        
        .checkbox-group { 
            display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; padding: 10px; 
            border: 1px dashed #ccc; border-radius: 5px; max-height: 250px; overflow-y: auto; 
            background-color: #fafafa;
        }

        /* Checkbox Labels (Tag Buttons) - Note: The input is hidden inside the label */
        .checkbox-group label { 
            /* Label is now the visible button */
            background-color: #f0f0f0; color: #6c757d; padding: 8px 14px; border-radius: 25px; 
            cursor: pointer; transition: all 0.2s; font-size: 14px; white-space: nowrap; 
            border: 1px solid #d4d4d4; box-shadow: 0 1px 2px rgba(0,0,0,0.02);
            /* Important: Need to use display: block/inline-block if not using the adjacent selector method correctly */
            display: inline-flex; /* Use inline-flex for better centering if needed */
            align-items: center;
        }

        /* Hide the actual checkbox input */
        .checkbox-group input[type="checkbox"] { display: none; }
        
        /* * FIX/ENHANCEMENT: Use the JavaScript-toggled class for a reliable solution.
         * The original CSS structure often relies on the input and label being adjacent siblings, 
         * but here the input is nested. The following CSS and the JS below fix this.
         */
        
        /* Style for the selected label (using the JS-toggled class on the label itself) */
        .checkbox-group label.checked-label { 
            background-color: #dc3545; 
            color: white; 
            border-color: #c82333; 
            font-weight: bold; 
            box-shadow: 0 4px 12px rgba(220, 53, 69, 0.7); 
            transform: scale(1.03); 
        }

        /* If you prefer to stick to the pure CSS method, use a structure where input and label are siblings:
           (We will stick to the nested structure and use JS for safety) 
        */


        /* Common Input/Select Style */
        input[type="text"], select { 
            padding: 8px; border: 1px solid #ccc; border-radius: 5px; margin-right: 5px; 
            box-sizing: border-box; display: inline-block;
        }
        select { margin-bottom: 5px; }
        
        button { 
            padding: 12px 25px; background-color: #007bff; color: white; border: none; 
            border-radius: 5px; cursor: pointer; margin-top: 20px; font-size: 16px; 
            font-weight: bold; transition: background-color 0.3s; display: block; width: 100%;
        }
        button:hover { background-color: #0056b3; }
        
        textarea { 
            width: 100%; padding: 15px; border: 2px solid #007bff; border-radius: 5px; 
            box-sizing: border-box; margin-top: 10px; font-family: Consolas, monospace; font-size: 14px; 
            background-color: #f8f9fa; 
        }
        
        .category-title { font-weight: bold; margin-top: 15px; display: block; color: #007bff; font-size: 15px; padding-left: 5px; }
        hr { border: 0; height: 1px; background-color: #ccc; margin: 20px 0; }
        .output-section h2 { color: #dc3545; border-bottom: 2px solid #dc3545; }

        /* Section Detail Styles */
        #section-details-container {
            margin-top: 15px; padding: 15px; border: 1px solid #f0ad4e; border-radius: 5px; background-color: #fff9f3;
        }
        .section-detail {
            margin-bottom: 15px; padding: 10px; border-left: 5px solid #d9534f; background-color: #fff; border-radius: 3px;
        }
        .section-detail label {
            font-weight: bold; display: block; margin-bottom: 8px; color: #d9534f; border-bottom: 1px dotted #f0ad4e; padding-bottom: 3px;
            font-size: 14px;
        }
        .detail-row {
            display: flex; gap: 10px; flex-wrap: wrap; margin-top: 5px; margin-bottom: 10px;
        }
        .detail-row select {
            flex-grow: 1; min-width: 120px; margin-right: 0;
        }
        
        /* Instrument Multi-select Area Styles */
        .instrument-multiselect {
            margin-top: 10px;
            padding: 8px;
            border: 1px dashed #c0c0c0;
            border-radius: 4px;
            background-color: #f9f9f9;
        }
        .instrument-multiselect h4 {
            margin: 0 0 5px 0;
            font-size: 14px;
            color: #555;
            border-bottom: 1px dotted #ccc;
            padding-bottom: 3px;
        }
        .instrument-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 5px;
        }
        .instrument-list label {
            font-weight: normal;
            color: #333;
            margin-right: 5px;
            display: inline-block;
            border-bottom: none; 
            padding-bottom: 0;
            cursor: pointer;
            font-size: 13px;
            background-color: transparent; /* Override button style for nested labels */
            border: none;
            padding: 0;
            box-shadow: none;
        }
        .instrument-list label.checked-label {
            /* Highlight for nested instrument labels */
            font-weight: bold;
            color: #dc3545;
            text-decoration: underline;
            transform: none; /* No scale for nested labels */
            box-shadow: none;
        }
    </style>
</head>
<body>

    <h1>‚ú® Suno AI Prompt Builder ‚ú®</h1>
    
    <section id="style-selection">
        <h2>1. üéº Overall Music Style Module (Style of Music)</h2>
        <span class="category-title">‚≠ê Genre & Style Tags:</span>
        <div class="checkbox-group">
            <label><input type="checkbox" name="genre" value="Pop"> Pop</label>
            <label><input type="checkbox" name="genre" value="Rock"> Rock</label>
            <label><input type="checkbox" name="genre" value="Hip-Hop"> Hip-Hop</label>
            <label><input type="checkbox" name="genre" value="Electronic"> Electronic</label>
            <label><input type="checkbox" name="genre" value="Jazz"> Jazz</label>
            <label><input type="checkbox" name="genre" value="Classical"> Classical</label>
            <label><input type="checkbox" name="genre" value="Folk"> Folk</label>
            <label><input type="checkbox" name="genre" value="R&B"> R&B</label>
            <label><input type="checkbox" name="genre" value="Country"> Country</label>
            <label><input type="checkbox" name="genre" value="Reggae"> Reggae</label>
            <label><input type="checkbox" name="genre" value="Trot (Korean)"> Trot (Korean)</label>
            
            <label><input type="checkbox" name="subgenre_electronic" value="House"> House</label>
            <label><input type="checkbox" name="subgenre_electronic" value="Techno"> Techno</label>
            <label><input type="checkbox" name="subgenre_electronic" value="Ambient"> Ambient</label>
            <label><input type="checkbox" name="subgenre_electronic" value="Dubstep"> Dubstep</label>
            <label><input type="checkbox" name="subgenre_electronic" value="Trance"> Trance</label>

            <label><input type="checkbox" name="subgenre_rock" value="Alternative Rock"> Alternative Rock</label>
            <label><input type="checkbox" name="subgenre_rock" value="Hard Rock"> Hard Rock</label>
            <label><input type="checkbox" name="subgenre_rock" value="Indie Rock"> Indie Rock</label>
            <label><input type="checkbox" name="subgenre_rock" value="Progressive Rock"> Progressive Rock</label>

            <label><input type="checkbox" name="subgenre_hybrid" value="Indie Folk"> Indie Folk</label>
            <label><input type="checkbox" name="subgenre_hybrid" value="Jazz Fusion"> Jazz Fusion</label>
            <label><input type="checkbox" name="subgenre_hybrid" value="Electro-Swing"> Electro-Swing</label>
            <label><input type="checkbox" name="subgenre_hybrid" value="Trip-Hop"> Trip-Hop</label>
            <label><input type="checkbox" name="subgenre_hybrid" value="Cinematic Pop"> Cinematic Pop</label>
            <label><input type="checkbox" name="subgenre_niche" value="Goth"> Goth</label>
            <label><input type="checkbox" name="subgenre_niche" value="Shoegaze"> Shoegaze</label>
            <label><input type="checkbox" name="subgenre_niche" value="Stoner Rock"> Stoner Rock</label>
            <label><input type="checkbox" name="subgenre_niche" value="Ska Punk"> Ska Punk</label>
            <label><input type="checkbox" name="subgenre_niche" value="Glitch Hop"> Glitch Hop</label>
            <label><input type="checkbox" name="subgenre_niche" value="Future Bass"> Future Bass</label>
        </div>
        
        <hr>

        <span class="category-title">üóìÔ∏è Era & üåç Regional Styles:</span>
        <div class="checkbox-group">
            <label><input type="checkbox" name="era" value="80s Synthwave"> 80s Synthwave</label>
            <label><input type="checkbox" name="era" value="90s Grunge"> 90s Grunge</label>
            <label><input type="checkbox" name="era" value="70s Funk"> 70s Funk</label>
            <label><input type="checkbox" name="era" value="Y2K Pop"> Y2K Pop</label>
            <label><input type="checkbox" name="era" value="Big Band Era"> Big Band Era</label>
            <label><input type="checkbox" name="regional" value="Afrobeat"> Afrobeat</label>
            <label><input type="checkbox" name="regional" value="Latin Jazz"> Latin Jazz</label>
            <label><input type="checkbox" name="regional" value="Bossa Nova"> Bossa Nova</label>
            <label><input type="checkbox" name="regional" value="Salsa"> Salsa</label>
            <label><input type="checkbox" name="regional" value="Gospel"> Gospel</label>
            <label><input type="checkbox" name="regional" value="Bollywood"> Bollywood</label>
            <label><input type="checkbox" name="regional" value="Ska"> Ska</label>
            <label><input type="checkbox" name="regional" value="Celtic Folk"> Celtic Folk</label>
            <label><input type="checkbox" name="regional" value="Klezmer Music"> Klezmer Music</label>
        </div>

        <hr>

        <span class="category-title">üß† Emotional Mood & üîä Vibe/Energy Tags:</span>
        <div class="checkbox-group">
            <label><input type="checkbox" name="energy_intensity_overall" value="High Energy"> High Energy</label>
            <label><input type="checkbox" name="energy_intensity_overall" value="Low Energy"> Low Energy</label>
            <label><input type="checkbox" name="energy_intensity_overall" value="Intense"> Intense</label>
            <label><input type="checkbox" name="energy_intensity_overall" value="Gentle"> Gentle</label>
            <label><input type="checkbox" name="energy_intensity_overall" value="Powerful"> Powerful</label>
            <label><input type="checkbox" name="energy_intensity_overall" value="Dynamic"> Dynamic</label>

            <label><input type="checkbox" name="mood_overall" value="Melancholic"> Melancholic</label>
            <label><input type="checkbox" name="mood_overall" value="Euphoric"> Euphoric</label>
            <label><input type="checkbox" name="mood_overall" value="Nostalgic"> Nostalgic</label>
            <label><input type="checkbox" name="mood_overall" value="Dreamy"> Dreamy</label>
            <label><input type="checkbox" name="mood_overall" value="Aggressive"> Aggressive</label>
            <label><input type="checkbox" name="mood_overall" value="Peaceful"> Peaceful</label>
            <label><input type="checkbox" name="mood_overall" value="Mysterious"> Mysterious</label>
            
            <label><input type="checkbox" name="texture_fx" value="Lo-Fi"> Lo-Fi</label>
            <label><input type="checkbox" name="texture_fx" value="Vinyl Hiss"> Vinyl Hiss</label>
            <label><input type="checkbox" name="texture_fx" value="Tape Saturation"> Tape Saturation</label>
            <label><input type="checkbox" name="texture_fx" value="Spacious"> Spacious</label>
            <label><input type="checkbox" name="texture_fx" value="Reverberant"> Reverberant</label>
            <label><input type="checkbox" name="texture_fx" value="Distorted"> Distorted</label>
            <label><input type="checkbox" name="texture_fx" value="Analog"> Analog</label>
            <label><input type="checkbox" name="texture_fx" value="Warm Mix"> Warm Mix</label>
            <label><input type="checkbox" name="texture_fx" value="Crystal Clear"> Crystal Clear</label>
            <label><input type="checkbox" name="texture_fx" value="Dry Mix"> Dry Mix</label>
            <label><input type="checkbox" name="texture_fx" value="Crisp"> Crisp</label>
        </div>

        <hr>
        
        <span class="category-title">üé§ Vocal Gender/Type and BPM Selection:</span>
        <div style="display: flex; gap: 10px; margin-top: 15px; margin-bottom: 15px;">
            <select id="overallVocalGender">
                <option value="">-- Vocal Gender/Type (Optional) --</option>
                <option value="Male Vocals">Male Vocals</option>
                <option value="Female Vocals">Female Vocals</option>
                <option value="Child Vocals">Child Vocals</option>
                <option value="Duet Vocals">Duet Vocals</option>
                <option value="Harmonies">Harmonies</option>
                <option value="Choir">Choir</option>
                <option value="No Vocals">No Vocals</option>
            </select>
            
            <input type="text" id="overallBpm" placeholder="Exact BPM Value (e.g., 110)">
        </div>

        <span class="category-title">üó£Ô∏è Additional Vocal Styles/Techniques/Characteristics:</span>
        <div class="checkbox-group">
            <label><input type="checkbox" name="vocal_style_overall" value="Powerful Vocals"> Powerful Vocals</label>
            <label><input type="checkbox" name="vocal_style_overall" value="Whispered Vocals"> Whispered Vocals</label>
            <label><input type="checkbox" name="vocal_style_overall" value="Smooth Vocals"> Smooth Vocals</label>
            <label><input type="checkbox" name="vocal_style_overall" value="Raspy Voice"> Raspy Voice</label>
            <label><input type="checkbox" name="vocal_style_overall" value="Clear Voice"> Clear Voice</label>
            <label><input type="checkbox" name="vocal_style_overall" value="Deep Voice"> Deep Voice</label>
            <label><input type="checkbox" name="vocal_style_overall" value="High Voice"> High Voice</label>
            <label><input type="checkbox" name="vocal_style_overall" value="Soulful Voice"> Soulful Voice</label>

            <label><input type="checkbox" name="vocal_style_overall" value="Falsetto"> Falsetto</label>
            <label><input type="checkbox" name="vocal_style_overall" value="Vibrato"> Vibrato</label>
            <label><input type="checkbox" name="vocal_style_overall" value="Melismatic"> Melismatic</label>
            <label><input type="checkbox" name="vocal_style_overall" value="Staccato Vocals"> Staccato Vocals</label>
            <label><input type="checkbox" name="vocal_style_overall" value="Legato Vocals"> Legato Vocals</label>
            <label><input type="checkbox" name="vocal_style_overall" value="Ad-libs"> Ad-libs</label>
            <label><input type="checkbox" name="vocal_style_overall" value="Shouting"> Shouting</label>
            <label><input type="checkbox" name="vocal_style_overall" value="Scat Singing"> Scat Singing</label>
            <label><input type="checkbox" name="vocal_style_overall" value="Yodeling"> Yodeling</label>
        </div>

    </section>

    <hr>
    
    <section>
        <h2>2. üìù Song Structure and Section Details Module</h2>
        <span class="category-title">Select Desired Song Structure Template (Required):</span>
        <select id="structureType" onchange="updateSectionDetails(this.value);">
            <option value="">-- Select Structure Type --</option>
            <optgroup label="--- üé§ Pop Music Structure ---">
                <option value="StandardPop">Standard Pop (Verse-Chorus-Bridge)</option>
                <option value="HookFocusPop">Hook Focus Pop (Chorus First)</option>
                <option value="KPopDance">K-Pop/Dance Pop (with Dance Break)</option>
            </optgroup>
            <optgroup label="--- üé∏ Rock Music Structure ---">
                <option value="ClassicRock">Classic Rock (Guitar Solo)</option>
                <option value="AlternativeGrunge">Alternative/Grunge (Soft-Loud Contrast)</option>
                <option value="ProgressiveRock">Progressive Rock (Complex Interlude)</option>
            </optgroup>
            <optgroup label="--- üéß Hip-Hop/R&B Structure ---">
                <option value="StandardHipHop">Standard Hip-Hop (Verse-Hook)</option>
                <option value="R&BSoul">R&B/Soul (Ad-libs, Harmony)</option>
                <option value="TrapStreet">Trap/Street (Beat Drop Emphasis)</option>
            </optgroup>
            <optgroup label="--- üîä EDM/Dance Music Structure ---">
                <option value="HouseTechno">House/Techno (Build-up & Drop)</option>
                <option value="TranceDubstep">Trance/Dubstep (Climactic Drop)</option>
                <option value="LoFiAmbient">Lo-Fi/Ambient (Seamless Loop)</option>
            </optgroup>
            <optgroup label="--- üé∑ Jazz/Blues Structure ---">
                <option value="StandardBlues">Blues (12-Bar, Improv Solo)</option>
                <option value="JazzStandard">Jazz Standard (AABA Form)</option>
            </optgroup>
            <optgroup label="--- üéª Cinematic/Classical Structure ---">
                <option value="CinematicScore">Cinematic Score (Tension & Climax)</option>
                <option value="ModernClassical">Modern Classical (Movement Division)</option>
            </optgroup>
             <optgroup label="--- üíÉ Trot Structure Extension ---">
                <option value="StandardTrot">Standard Trot (Instrumental Break)</option>
                <option value="DanceTrot">Dance Trot</option>
                <option value="SlowTrot">Slow Trot (Emotional Ballad Type)</option>
            </optgroup>
             <optgroup label="--- üéπ Ballad Structure Extension ---">
                <option value="PowerBallad">Power Ballad (Key Change, Max Power)</option>
                <option value="R&BBallad">R&B Ballad (Vocal Harmony, Sax/Rhodes Interlude)</option>
                <option value="AcousticBallad">Acoustic Ballad (Simple, Verse 3)</option>
            </optgroup>
            <optgroup label="--- üå≤ Folk/Country/Reggae Structure ---">
                <option value="StandardFolk">Standard Folk (Verse 3 Interlude)</option>
                <option value="BluegrassIrish">Bluegrass/Irish (Fast Solo, Breakdown)</option>
                <option value="NarrativeCountry">Narrative Country (Pedal Steel, Long Story)</option>
                <option value="StandardReggae">Reggae Standard (Dub Break, Toasting)</option>
            </optgroup>

        </select>
        <p id="structureDesc" style="margin-top: 5px; color: #555;">Selected structure features: Please select a structure type.</p>

        <span class="category-title" style="margin-top: 15px;">üí° Section Style Details (Combobox + Multi-select)</span>
        <div id="section-details-container">
            <p style="color: #a94442;">Select a structure type to reveal fields for BPM, Mood, Instruments, and Vocal Tone for each main section.</p>
        </div>
    </section>

    <button onclick="generatePrompt()">Final Prompt Generation and Update</button>

    <hr>
    
    <section class="output-section">
        <h2>Result 1: Style of Music</h2>
        <textarea id="outputStyle" rows="5" readonly placeholder="The core style tags applied to the entire song will appear here."></textarea>
        
        <h2>Result 2: Lyrics Template</h2>
        <textarea id="outputLyrics" rows="20" placeholder="The final lyric structure with section-specific BPM/Mood tags will appear here. Enter your lyrics directly inside the angle brackets (< >)."></textarea>
        
        <p style="color: #dc3545; font-weight: bold; margin-top: 10px;">*How to Use: Copy Result 1 to Suno's Style field, and Result 2 to the Lyrics field (filling in the content) and use it.</p>
    </section>

    <script>
        // C. [NEW] Function to ensure real-time checkbox visual feedback
        function setupCheckboxVisuals() {
            // Select all input type="checkbox" elements
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            
            checkboxes.forEach(checkbox => {
                // Initial check for pre-selected items (if any, though none are here)
                if (checkbox.checked) {
                    checkbox.parentElement.classList.add('checked-label');
                } else {
                    checkbox.parentElement.classList.remove('checked-label');
                }

                // Add change listener for real-time update
                checkbox.addEventListener('change', (event) => {
                    // event.target is the input checkbox
                    const label = event.target.parentElement;
                    if (event.target.checked) {
                        label.classList.add('checked-label');
                    } else {
                        label.classList.remove('checked-label');
                    }

                    // Re-generate prompt to reflect current selections in the output
                    generatePrompt();
                });
            });
        }
        
        // A. Section Combobox Options Data (Updated)
        const detailOptions = {
            tempo: [
                { value: '', label: '1. -- BPM/Tempo (Select) --' },
                { value: 'BPM 80', label: 'BPM 80 (Slow)' },
                { value: 'BPM 110', label: 'BPM 110 (Medium)' },
                { value: 'BPM 140', label: 'BPM 140 (Fast)' },
                { value: 'BPM 180', label: 'BPM 180 (Very Fast)' },
                { value: 'Slow Tempo', label: 'Slow Tempo (60-80 BPM)' },
                { value: 'Medium Tempo', label: 'Medium Tempo (90-120 BPM)' },
                { value: 'Fast Tempo', label: 'Fast Tempo (130-180 BPM)' },
                { value: 'Very Fast', label: 'Very Fast (180+ BPM)' },
                { value: 'Double-time feel', label: 'Double-time feel' },
                { value: 'Half-time feel', label: 'Half-time feel' },
            ],
            // **[UPDATE]: Mood, Rhythm, Groove, Time Signature Tags Consolidated**
            rhythmAndMood: [
                { value: '', label: '2. -- Rhythm/Meter/Mood (Select) --' },
                
                // Time Signatures
                { value: '4/4 Time', label: '4/4 Time (Standard Meter)' },
                { value: '3/4 Time', label: '3/4 Time (Waltz Meter)' },
                { value: '6/8 Time', label: '6/8 Time (Compound Meter)' },
                { value: '5/4 Time', label: '5/4 Time (Odd Meter)' },

                // Rhythmic Feels
                { value: 'Straight Feel', label: 'Straight Feel' },
                { value: 'Swing Feel', label: 'Swing Feel (Jazz/Swing)' },
                { value: 'Shuffle Feel', label: 'Shuffle Feel' },
                { value: 'Latin Feel', label: 'Latin Feel (Syncopated)' },

                // Groove Types
                { value: 'Backbeat', label: 'Backbeat (Emphasis on 2/4)' },
                { value: 'Off-beat', label: 'Off-beat (Emphasis on weak beats, Reggae)' },
                { value: 'Polyrhythm', label: 'Polyrhythm' },
                { value: 'Cross-rhythm', label: 'Cross-rhythm' },

                // Energy and Intensity Tags
                { value: 'High Energy', label: 'High Energy' },
                { value: 'Low Energy', label: 'Low Energy' },
                { value: 'Building Energy', label: 'Building Energy' },
                { value: 'Intense', label: 'Intense' },
                { value: 'Gentle', label: 'Gentle' },
                { value: 'Dynamic', label: 'Dynamic' },

                // Emotional Mood Tags
                { value: 'Melancholic', label: 'Melancholic' }, 
                { value: 'Euphoric', label: 'Euphoric' }, 
                { value: 'Nostalgic', label: 'Nostalgic' }, 
                { value: 'Dreamy', label: 'Dreamy' }, 
                { value: 'Aggressive', label: 'Aggressive' }, 
                { value: 'Peaceful', label: 'Peaceful' }, 
                { value: 'Mysterious', label: 'Mysterious' }, 
                { value: 'Dramatic', label: 'Dramatic' },

                // Performance/Mixing Details 
                { value: 'Tight Drums', label: 'Tight Drums' },
                { value: 'Swing Beat', label: 'Swing Beat' },
                { value: 'Walking Bassline', label: 'Walking Bassline' },
                { value: 'Dry Mix', label: 'Dry Mix (No Reverb)' },
                { value: 'City Street SFX', label: 'City Street SFX' }
            ],
            // **[UPDATE]: Vocal Style, Technique, Character Tags Consolidated**
            vocal: [
                { value: '', label: '3. -- Vocal Tone/Technique (Select) --' },
                // Styles
                { value: 'Powerful Vocals', label: 'Powerful Vocals' },
                { value: 'Whispered Vocals', label: 'Whispered Vocals' },
                { value: 'Smooth Vocals', label: 'Smooth Vocals' },
                { value: 'Harmonies', label: 'Harmonies' },
                { value: 'Choir', label: 'Choir' },
                // Techniques
                { value: 'Falsetto', label: 'Falsetto' },
                { value: 'Vibrato', label: 'Vibrato' },
                { value: 'Melismatic', label: 'Melismatic' },
                { value: 'Staccato Vocals', label: 'Staccato Vocals' },
                { value: 'Legato Vocals', label: 'Legato Vocals' },
                // Character and Action
                { value: 'Raspy Voice', label: 'Raspy Voice' },
                { value: 'Clear Voice', label: 'Clear Voice' },
                { value: 'Deep Voice', label: 'Deep Voice' },
                { value: 'High Voice', label: 'High Voice' },
                { value: 'Soulful Voice', label: 'Soulful Voice' },
                { value: 'Ad-libs', label: 'Ad-libs' },
                { value: 'Shouting', label: 'Shouting' },
                { value: 'Scat Singing', label: 'Scat Singing' },
                { value: 'Yodeling', label: 'Yodeling' }
            ],
            // Instrument Categories (Expanded to include traditional instruments)
            instrumentCategories: {
                // Melody, Harmony (Keys, Strings, Brass/Woodwind)
                melodyHarmony: [
                    { value: 'Piano', label: 'Piano' },
                    { value: 'Electric Piano', label: 'Electric Piano' },
                    { value: 'Synthesizer', label: 'Synthesizer' },
                    { value: 'Organ', label: 'Organ' },
                    { value: 'Strings Section', label: 'Strings Section' },
                    { value: 'Electric Guitar', label: 'Electric Guitar' },
                    { value: 'Acoustic Guitar', label: 'Acoustic Guitar' },
                    { value: 'Violin', label: 'Violin' },
                    { value: 'Cello', label: 'Cello' },
                    { value: 'Saxophone', label: 'Saxophone' },
                    { value: 'Trumpet', label: 'Trumpet' },
                    { value: 'Flute', label: 'Flute' },
                    { value: 'Clarinet', label: 'Clarinet' }
                ],
                // Rhythm, Bass, Percussion
                rhythm: [
                    { value: 'Bass Guitar', label: 'Bass Guitar' },
                    { value: '808 Bass', label: '808 Bass' },
                    { value: 'Drums', label: 'Full Drum Kit' },
                    { value: 'Electronic Drums', label: 'Electronic Drums' },
                    { value: 'Hand Percussion', label: 'Hand Percussion' },
                    { value: 'Janggu (Korean Drum)', label: 'Janggu' },
                    { value: 'Taiko Drums', label: 'Taiko Drums' },
                    { value: 'Tabla', label: 'Tabla' },
                    { value: 'Djembe', label: 'Djembe' },
                    { value: 'Slap Bass', label: 'Slap Bass' }
                ],
                // Special and Regional Instruments
                specialRegion: [
                    { value: 'Gayageum (Korean)', label: 'Gayageum' },
                    { value: 'Haegeum (Korean)', label: 'Haegeum' },
                    { value: 'Daegum (Korean)', label: 'Daegum' },
                    { value: 'Shakuhachi', label: 'Shakuhachi' },
                    { value: 'Koto', label: 'Koto' },
                    { value: 'Sitar', label: 'Sitar' },
                    { value: 'Pedal Steel Guitar', label: 'Pedal Steel Guitar' }
                ],
                // Sound Effects and Texture (Including FX/Texture)
                fxTexture: [
                    { value: 'Distorted Guitar', label: 'Distorted Guitar' },
                    { value: 'Reverb FX', label: 'Reverb FX' },
                    { value: 'Echo Delay', label: 'Echo Delay' },
                    { value: 'Scratching', label: 'Scratching (DJ)' },
                    { value: 'Filtered Sweep', label: 'Filtered Sweep' },
                    { value: 'Arpeggiator', label: 'Arpeggiator' },
                    { value: 'Soundscape', label: 'Soundscape' },
                    { value: 'Vinyl Hiss', label: 'Vinyl Hiss' },
                    { value: 'Rainy Day SFX', label: 'Rainy Day SFX' },
                    { value: 'Caf√© Noise SFX', label: 'Caf√© Noise SFX' }
                ]
            }
        };

        // B. Structure Details and Template Data (Translated)
        const structureData = {
            "StandardPop": {
                desc: "The most basic and successful structure. Builds tension in the [Bridge] before the final explosive chorus.",
                sections: ['Intro', 'Verse 1', 'Pre-Chorus', 'Chorus', 'Verse 2', 'Pre-Chorus', 'Chorus', 'Bridge', 'Chorus', 'Outro'],
                template: {
                    'Intro': '[Intro] (Low Energy)\n<Intro lyric line>',
                    'Verse 1': '[Verse 1] (Medium Energy)\n<Verse 1 lyrics 4 lines>',
                    'Pre-Chorus': '[Pre-Chorus] (Building Energy)\n<Pre-Chorus lyrics 2 lines>',
                    'Chorus': '[Chorus] (High Energy)\n<Chorus lyrics 4 lines>',
                    'Verse 2': '[Verse 2] (Medium Energy)\n<Verse 2 lyrics 4 lines>',
                    'Bridge': '[Bridge] (Gentle, Mood Switch)\n<Bridge lyrics 2 lines>',
                    'Outro': '[Outro] (Fade out)\n<Outro lyric line>'
                }
            },
            "HookFocusPop": {
                desc: "Presents the chorus (hook) immediately after the intro to instantly captivate the audience.",
                sections: ['Intro', 'Chorus', 'Verse 1', 'Chorus', 'Verse 2', 'Chorus', 'Outro'],
                template: {
                    'Intro': '[Intro] (Short Hook Motif)\n<Intro lyric line>',
                    'Chorus': '[Chorus] (High Energy)\n<Chorus lyrics 4 lines>',
                    'Verse 1': '[Verse 1] (Medium Energy, Subtle)\n<Verse 1 lyrics 4 lines>',
                    'Verse 2': '[Verse 2] (Medium Energy)\n<Verse 2 lyrics 4 lines>',
                    'Outro': '[Outro] (Low Energy, Vocal Ad-libs, Fade out)\n<Outro lyric line>'
                }
            },
            "KPopDance": {
                desc: "Complex, emphasizing rhythm and mood shifts with [Post-Chorus] and [Dance Break].",
                sections: ['Intro', 'Verse 1', 'Pre-Chorus', 'Chorus', 'Post-Chorus', 'Verse 2', 'Pre-Chorus', 'Chorus', 'Dance Break', 'Bridge', 'Chorus', 'Outro'],
                template: {
                    'Intro': '[Intro] (Low Energy, Synth Riser)\n<Intro lyric line>',
                    'Verse 1': '[Verse 1] (Medium Energy)\n<Verse 1 lyrics 3 lines>',
                    'Pre-Chorus': '[Pre-Chorus] (Building Energy, Tension)\n<Pre-Chorus lyrics 2 lines>',
                    'Chorus': '[Chorus] (High Energy)\n<Chorus lyrics 4 lines>',
                    'Post-Chorus': '[Post-Chorus] (Explosive Energy, Rhythm Switch)\n<Post-Chorus lyrics 2 lines>',
                    'Verse 2': '[Verse 2] (Medium Energy, Rap Focus)\n<Verse 2 rap lyrics 3 lines>',
                    'Dance Break': '[Dance Break] (Intense, Heavy Beat, No Vocals)',
                    'Bridge': '[Bridge] (Gentle, Mood Switch)\n<Bridge lyrics 2 lines>',
                    'Outro': '[Outro] (High Energy, FX Fade)\n<Outro lyric line>'
                }
            },
            "ClassicRock": {
                desc: "Places the solo part between the chorus and bridge, balancing the song's center.",
                sections: ['Intro', 'Verse 1', 'Chorus', 'Verse 2', 'Chorus', 'Guitar Solo', 'Bridge', 'Chorus', 'Outro'],
                template: {
                    'Intro': '[Intro] (Medium Energy, Guitar Riff)\n<Intro lyric line>',
                    'Verse 1': '[Verse 1] (Medium Energy)\n<Verse 1 lyrics 4 lines>',
                    'Chorus': '[Chorus] (High Energy, Powerful)\n<Chorus lyrics 4 lines>',
                    'Verse 2': '[Verse 2] (Medium Energy)\n<Verse 2 lyrics 4 lines>',
                    'Guitar Solo': '[Guitar Solo] (Intense, Distorted, Harmonic Minor)',
                    'Bridge': '[Bridge] (Gentle, New Chord Progression)\n<Bridge lyrics 2 lines>',
                    'Outro': '[Outro] (High Energy, Drum Fill)\n<Outro lyric line>'
                }
            },
            "AlternativeGrunge": {
                desc: "Expresses emotional explosion through extreme Soft/Loud dynamic contrast.",
                sections: ['Intro', 'Verse 1 (Soft)', 'Chorus (Loud)', 'Verse 2 (Soft)', 'Chorus (Loud)', 'Bridge (Quiet)', 'Climactic Chorus', 'Outro'],
                template: {
                    'Intro': '[Intro] (Low Energy, Quiet Guitar)',
                    'Verse 1 (Soft)': '[Verse 1] (Low Energy, Whispered Vocals)\n<Verse 1 lyrics 4 lines>',
                    'Chorus (Loud)': '[Chorus] (High Energy, Distorted Guitar, Shouting)\n<Chorus lyrics 4 lines>',
                    'Verse 2 (Soft)': '[Verse 2] (Low Energy, Subtle Drums)\n<Verse 2 lyrics 4 lines>',
                    'Bridge (Quiet)': '[Bridge] (Very Low Energy, Melancholic)\n<Bridge lyrics 2 lines>',
                    'Climactic Chorus': '[Chorus] (Maximum Energy, Full Power, Aggressive)\n<Chorus lyrics 4 lines>',
                    'Outro': '[Outro] (Noise Fade, Feedback)\n<Outro lyric line>'
                }
            },
            "ProgressiveRock": {
                desc: "Complex and long structure with instrumental parts, featuring [Complex Interlude].",
                sections: ['Intro (Ambient)', 'Verse 1', 'Chorus', 'Complex Interlude', 'Verse 2', 'Chorus', 'Bridge (Time Change)', 'Outro (Instrumental Finish)'],
                template: {
                    'Intro (Ambient)': '[Intro] (Mysterious, Spacious, Long)\n<Intro lyric line>',
                    'Verse 1': '[Verse 1] (Medium Tempo, Dynamic)\n<Verse 1 lyrics 6 lines>',
                    'Chorus': '[Chorus] (High Energy, Powerful)\n<Chorus lyrics 4 lines>',
                    'Complex Interlude': '[Interlude] (7/8 Time, Intense, Synth Solo, Polyrhythm)',
                    'Verse 2': '[Verse 2] (Medium Tempo, Storytelling)\n<Verse 2 lyrics 6 lines>',
                    'Bridge (Time Change)': '[Bridge] (Waltz Meter, Gentle, Mood Switch)\n<Bridge lyrics 3 lines>',
                    'Outro (Instrumental Finish)': '[Outro] (Instrumental Fade, Strings Section)\n<Outro lyric line>'
                }
            },
            "StandardHipHop": {
                desc: "Standard Hip-Hop structure, repeating the [Hook] (Chorus) after the verse.",
                sections: ['Intro', 'Verse 1', 'Hook', 'Verse 2', 'Hook', 'Outro'],
                template: {
                    'Intro': '[Intro] (Low Energy, Short Beat)\n<Intro lyric line>',
                    'Verse 1': '[Verse 1] (Medium Energy, Rapping)\n<Verse 1 rap lyrics 4 lines>',
                    'Hook': '[Hook] (High Energy, Catchy)\n<Hook lyrics 4 lines>',
                    'Verse 2': '[Verse 2] (Medium Energy, Rapping)\n<Verse 2 rap lyrics 4 lines>',
                    'Outro': '[Outro] (Fade Out)\n<Outro lyric line>'
                }
            },
            "R&BSoul": {
                desc: "Smooth R&B structure focusing on vocal performance and harmony, featuring [Rhodes/Sax Interlude].",
                sections: ['Intro (Smooth)', 'Verse 1', 'Pre-Chorus', 'Chorus', 'Verse 2', 'Chorus', 'Rhodes/Sax Interlude', 'Bridge', 'Chorus (Ad-libs)', 'Outro (Vocal Run)'],
                template: {
                    'Intro (Smooth)': '[Intro] (Smooth, Electric Piano)\n<Intro lyric line>',
                    'Verse 1': '[Verse 1] (Gentle, Soulful Vocals)\n<Verse 1 lyrics 4 lines>',
                    'Pre-Chorus': '[Pre-Chorus] (Building, Harmonies)\n<Pre-Chorus lyrics 2 lines>',
                    'Chorus': '[Chorus] (Medium Energy, Lush)\n<Chorus lyrics 4 lines>',
                    'Verse 2': '[Verse 2] (Gentle, Deep Bassline)\n<Verse 2 lyrics 4 lines>',
                    'Rhodes/Sax Interlude': '[Interlude] (Saxophone Solo, Rhodes Piano)',
                    'Bridge': '[Bridge] (Melismatic, Key Change)\n<Bridge lyrics 2 lines>',
                    'Chorus (Ad-libs)': '[Chorus] (High Energy, Ad-libs, Choir)\n<Chorus lyrics 4 lines>',
                    'Outro (Vocal Run)': '[Outro] (Vocal Run, Fade out)\n<Outro lyric line>'
                }
            },
            "TrapStreet": {
                desc: "Heavy beat and bass, emphasizing the beat drop with minimal melodic changes.",
                sections: ['Intro (Beat Setup)', 'Verse 1 (Fast Rap)', 'Hook', 'Verse 2 (Slow Rap)', 'Beat Drop/Breakdown', 'Hook', 'Outro (808 Bass Finish)'],
                template: {
                    'Intro (Beat Setup)': '[Intro] (808 Bass, Hi-hats)\n<Intro lyric line>',
                    'Verse 1 (Fast Rap)': '[Verse 1] (Fast Rap, Intense)\n<Verse 1 rap lyrics 4 lines>',
                    'Hook': '[Hook] (High Energy, Ad-libs)\n<Hook lyrics 4 lines>',
                    'Verse 2 (Slow Rap)': '[Verse 2] (Slow Flow, Dark Mood)\n<Verse 2 rap lyrics 4 lines>',
                    'Beat Drop/Breakdown': '[Breakdown] (Max Intensity, Filtered 808, No Vocals)',
                    'Outro (808 Bass Finish)': '[Outro] (808 Bass, Fade out)\n<Outro lyric line>'
                }
            },
            "HouseTechno": {
                desc: "Dance track with a build-up and drop structure.",
                sections: ['Intro (Beat Start)', 'Build-up 1', 'Drop 1', 'Breakdown 1', 'Build-up 2', 'Drop 2', 'Outro (Fade Out)'],
                template: {
                    'Intro (Beat Start)': '[Intro] (4/4 Beat, Synth Riff)',
                    'Build-up 1': '[Build-up] (Filter Sweep, Riser FX, Building Energy)',
                    'Drop 1': '[Drop] (High Energy, Heavy Kick, Bassline)',
                    'Breakdown 1': '[Breakdown] (Medium Energy, Ambient Pad, Filter FX)',
                    'Build-up 2': '[Build-up] (Intense, Snare Roll)',
                    'Drop 2': '[Drop] (Climactic, Staccato Synths)',
                    'Outro (Fade Out)': '[Outro] (Beat Fade, Echo Delay)'
                }
            },
            "TranceDubstep": {
                desc: "Focuses on melodic phrases and climactic drops.",
                sections: ['Intro (Ambient Pad)', 'Phrase 1', 'Build-up', 'Climactic Drop', 'Breakdown (Melodic)', 'Outro (Reverberant)'],
                template: {
                    'Intro (Ambient Pad)': '[Intro] (Spacious, Dreamy)',
                    'Phrase 1': '[Phrase 1] (Medium Tempo, Arpeggiator)',
                    'Build-up': '[Build-up] (Intense, Snare Roll, Highpass Filter)',
                    'Climactic Drop': '[Drop] (Wobble Bass, Max Volume, Euphoric)',
                    'Breakdown (Melodic)': '[Breakdown] (Melancholic, Piano Chord, Gentle)',
                    'Outro (Reverberant)': '[Outro] (Reverberant, Synth Pad, Fade out)'
                }
            },
            "LoFiAmbient": {
                desc: "Seamless, repetitive, and peaceful structure.",
                sections: ['Loop A (Quiet)', 'Loop B (Dynamic)', 'Loop A (Quiet)', 'Outro (Vinyl Hiss)'],
                template: {
                    'Loop A (Quiet)': '[Loop A] (Lo-Fi, Vinyl Hiss, Quiet Drums)',
                    'Loop B (Dynamic)': '[Loop B] (Slightly Dynamic, Cello Melody, Clear Mix)',
                    'Outro (Vinyl Hiss)': '[Outro] (Fade out, Rainy Day SFX)'
                }
            },
            "StandardBlues": {
                desc: "Classic 12-Bar Blues structure with improvisation.",
                sections: ['Intro', 'Chorus 1 (12-Bar)', 'Chorus 2 (12-Bar)', 'Harmonica/Guitar Solo (12-Bar)', 'Chorus 3 (12-Bar)', 'Outro'],
                template: {
                    'Intro': '[Intro] (Blues Scale, Low Energy)',
                    'Chorus 1 (12-Bar)': '[Chorus 1] (Shuffle Feel, Raspy Voice)\n<Chorus lyrics 3 lines>',
                    'Chorus 2 (12-Bar)': '[Chorus 2] (Shuffle Feel, Walking Bassline)\n<Chorus lyrics 3 lines>',
                    'Harmonica/Guitar Solo (12-Bar)': '[Solo] (Improvisation, Distorted Guitar)',
                    'Chorus 3 (12-Bar)': '[Chorus 3] (Powerful Vocals)\n<Chorus lyrics 3 lines>',
                    'Outro': '[Outro] (Piano Chord, Fade out)'
                }
            },
            "JazzStandard": {
                desc: "Classic AABA form with instrument solo break.",
                sections: ['Intro', 'A Section', 'A Section', 'B Section (Bridge)', 'A Section', 'Solo Break', 'A Section', 'Outro'],
                template: {
                    'Intro': '[Intro] (Swing Feel, Piano Chord)',
                    'A Section': '[A Section] (Medium Tempo, Swing Feel, Smooth Vocals)\n<A section lyrics 4 lines>',
                    'B Section (Bridge)': '[B Section] (Mood Switch, Gentle, New Chord Progression)\n<B section lyrics 4 lines>',
                    'Solo Break': '[Solo Break] (Saxophone Solo, Scat Singing)',
                    'Outro': '[Outro] (Fade out, Clarinet Solo)'
                }
            },
            "CinematicScore": {
                desc: "Orchestral piece focused on building tension and climactic release.",
                sections: ['Overture (Gentle)', 'Tension Build-up (Staccato)', 'Climax (Powerful)', 'Resolution (Peaceful)'],
                template: {
                    'Overture (Gentle)': '[Overture] (Strings Section, Peaceful, Slow Tempo)',
                    'Tension Build-up (Staccato)': '[Build-up] (Staccato, Taiko Drums, Building Energy)',
                    'Climax (Powerful)': '[Climax] (Max Intensity, Brass Section, Epic Choir)',
                    'Resolution (Peaceful)': '[Resolution] (Flute Melody, Peaceful, Fade out)'
                }
            },
            "ModernClassical": {
                desc: "Focuses on instrument movements rather than vocal parts.",
                sections: ['Movement I (Slow)', 'Movement II (Fast)', 'Movement III (Climactic)', 'Coda'],
                template: {
                    'Movement I (Slow)': '[Movement I] (Cello Solo, Melancholic, 3/4 Time)',
                    'Movement II (Fast)': '[Movement II] (Fast Tempo, Violin, Dynamic)',
                    'Movement III (Climactic)': '[Movement III] (Brass Section, Powerful, Dramatic)',
                    'Coda': '[Coda] (Piano, Gentle Fade out)'
                }
            },
            "StandardTrot": {
                desc: "A bright and energetic Korean Trot structure with an instrumental break.",
                sections: ['Intro', 'Verse 1', 'Chorus', 'Verse 2', 'Chorus', 'Instrumental Break', 'Chorus', 'Outro'],
                template: {
                    'Intro': '[Intro] (High Energy, Brass Section)',
                    'Verse 1': '[Verse 1] (Medium Tempo, Trot Feel)\n<Verse 1 lyrics 4 lines>',
                    'Chorus': '[Chorus] (High Energy, Full Orchestra)\n<Chorus lyrics 4 lines>',
                    'Verse 2': '[Verse 2] (Medium Tempo, More Emotional)\n<Verse 2 lyrics 4 lines>',
                    'Instrumental Break': '[Break] (Saxophone Solo, Upbeat Drums)',
                    'Outro': '[Outro] (Fade Out, Ad-libs)'
                }
            },
            "DanceTrot": {
                desc: "Upbeat Trot style with strong electronic and dance elements.",
                sections: ['Intro (Synth Beat)', 'Verse 1', 'Pre-Chorus', 'Chorus (Explosive)', 'Dance Break (Electronic)', 'Verse 2', 'Chorus', 'Outro'],
                template: {
                    'Intro (Synth Beat)': '[Intro] (Electronic Drums, Synth Bass)',
                    'Verse 1': '[Verse 1] (Medium Fast Tempo, Staccato Vocals)\n<Verse 1 lyrics 4 lines>',
                    'Pre-Chorus': '[Pre-Chorus] (Building Energy, Riser FX)\n<Pre-Chorus lyrics 2 lines>',
                    'Chorus (Explosive)': '[Chorus] (Max Energy, Dubstep Influences)\n<Chorus lyrics 4 lines>',
                    'Dance Break (Electronic)': '[Break] (Intense, Filtered Sweep, No Vocals)',
                    'Verse 2': '[Verse 2] (Medium Fast Tempo, Rapping Style)\n<Verse 2 lyrics 4 lines>',
                    'Outro': '[Outro] (Synth Riff Fade out)'
                }
            },
            "SlowTrot": {
                desc: "Emotional Trot ballad with a focus on powerful, soulful vocals.",
                sections: ['Intro (Piano/Strings)', 'Verse 1 (Quiet)', 'Chorus (Emotional)', 'Verse 2 (Building)', 'Climactic Chorus', 'Bridge (Key Change)', 'Final Chorus', 'Outro'],
                template: {
                    'Intro (Piano/Strings)': '[Intro] (Piano, Strings Section, Melancholic)',
                    'Verse 1 (Quiet)': '[Verse 1] (Slow Tempo, Clear Voice)\n<Verse 1 lyrics 4 lines>',
                    'Chorus (Emotional)': '[Chorus] (Powerful Vocals, Dramatic)\n<Chorus lyrics 4 lines>',
                    'Verse 2 (Building)': '[Verse 2] (Building Energy, Deep Voice)\n<Verse 2 lyrics 4 lines>',
                    'Climactic Chorus': '[Chorus] (Maximum Intensity, Full Band)\n<Chorus lyrics 4 lines>',
                    'Bridge (Key Change)': '[Bridge] (Key Change, Falsetto, Vibrato)\n<Bridge lyrics 2 lines>',
                    'Final Chorus': '[Chorus] (Explosive, High Voice)\n<Chorus lyrics 4 lines>',
                    'Outro': '[Outro] (Fade out, Vocal Run)'
                }
            },
            "PowerBallad": {
                desc: "High-power ballad structure reaching maximum intensity with a final key change.",
                sections: ['Intro (Piano)', 'Verse 1 (Soft)', 'Pre-Chorus', 'Chorus', 'Verse 2', 'Chorus', 'Guitar Solo (Melodic)', 'Bridge (Key Change)', 'Climactic Chorus', 'Outro (High Note)'],
                template: {
                    'Intro (Piano)': '[Intro] (Piano, Gentle)',
                    'Verse 1 (Soft)': '[Verse 1] (Low Energy, Smooth Vocals)\n<Verse 1 lyrics 4 lines>',
                    'Pre-Chorus': '[Pre-Chorus] (Building Energy, Strings)\n<Pre-Chorus lyrics 2 lines>',
                    'Chorus': '[Chorus] (High Energy, Powerful Vocals)\n<Chorus lyrics 4 lines>',
                    'Verse 2': '[Verse 2] (Medium Energy, Drums Enter)\n<Verse 2 lyrics 4 lines>',
                    'Guitar Solo (Melodic)': '[Solo] (Melodic Guitar Solo, Reverb FX)',
                    'Bridge (Key Change)': '[Bridge] (Mood Switch, Key Change, Gentle)\n<Bridge lyrics 2 lines>',
                    'Climactic Chorus': '[Chorus] (Maximum Power, Choir, Shouting)\n<Chorus lyrics 4 lines>',
                    'Outro (High Note)': '[Outro] (Fade out, High Note Sustained)'
                }
            },
            "R&BBallad": {
                desc: "Romantic R&B ballad with a focus on harmony and smooth instrumental interludes.",
                sections: ['Intro (Rhodes)', 'Verse 1', 'Chorus (Harmony)', 'Verse 2', 'Chorus', 'Sax Interlude', 'Bridge (Ad-libs)', 'Chorus (Ad-libs)', 'Outro (Vocal Run)'],
                template: {
                    'Intro (Rhodes)': '[Intro] (Electric Piano, Smooth)',
                    'Verse 1': '[Verse 1] (Gentle, Whispered Vocals)\n<Verse 1 lyrics 4 lines>',
                    'Chorus (Harmony)': '[Chorus] (Medium Energy, Harmonies, Lush Mix)\n<Chorus lyrics 4 lines>',
                    'Verse 2': '[Verse 2] (Medium Energy, Light Drums)\n<Verse 2 lyrics 4 lines>',
                    'Sax Interlude': '[Interlude] (Saxophone Solo, Soulful)',
                    'Bridge (Ad-libs)': '[Bridge] (Building Energy, Ad-libs)\n<Bridge lyrics 2 lines>',
                    'Chorus (Ad-libs)': '[Chorus] (High Energy, Vibrato, Melismatic)\n<Chorus lyrics 4 lines>',
                    'Outro (Vocal Run)': '[Outro] (Vocal Run, Fade out)'
                }
            },
            "AcousticBallad": {
                desc: "Simple, introspective ballad structure, usually driven by guitar/piano and vocals.",
                sections: ['Intro (Acoustic)', 'Verse 1', 'Chorus', 'Verse 2', 'Chorus', 'Verse 3 (New Lyric)', 'Outro (Instrumental)'],
                template: {
                    'Intro (Acoustic)': '[Intro] (Acoustic Guitar, Gentle)',
                    'Verse 1': '[Verse 1] (Slow Tempo, Clear Voice)\n<Verse 1 lyrics 4 lines>',
                    'Chorus': '[Chorus] (Medium Energy, Simple Drums)\n<Chorus lyrics 4 lines>',
                    'Verse 2': '[Verse 2] (Slow Tempo, Storytelling)\n<Verse 2 lyrics 4 lines>',
                    'Verse 3 (New Lyric)': '[Verse 3] (Slightly Building, New Harmony)\n<Verse 3 lyrics 4 lines>',
                    'Outro (Instrumental)': '[Outro] (Acoustic Guitar, Peaceful Fade out)'
                }
            },
            "StandardFolk": {
                desc: "Focuses on storytelling, often with a simple verse-chorus structure and a central interlude.",
                sections: ['Intro', 'Verse 1', 'Chorus', 'Verse 2', 'Chorus', 'Interlude (Banjo/Fiddle)', 'Verse 3', 'Outro'],
                template: {
                    'Intro': '[Intro] (Acoustic Guitar, Folk Feel)',
                    'Verse 1': '[Verse 1] (Storytelling, Clear Voice)\n<Verse 1 lyrics 4 lines>',
                    'Chorus': '[Chorus] (Medium Energy, Harmonies)\n<Chorus lyrics 4 lines>',
                    'Verse 2': '[Verse 2] (Storytelling, Simple)\n<Verse 2 lyrics 4 lines>',
                    'Interlude (Banjo/Fiddle)': '[Interlude] (Fiddle Solo, Bluegrass Tempo)',
                    'Verse 3': '[Verse 3] (Emotional, Building)\n<Verse 3 lyrics 4 lines>',
                    'Outro': '[Outro] (Fade out, Harmonica Solo)'
                }
            },
            "BluegrassIrish": {
                desc: "Fast, energetic, and instrumental-heavy structure for dancing.",
                sections: ['Intro', 'Instrumental A (Fast)', 'Breakdown (Quiet)', 'Instrumental B (Climactic)', 'Instrumental A (Repeat)', 'Outro'],
                template: {
                    'Intro': '[Intro] (Fast Tempo, Violin)',
                    'Instrumental A (Fast)': '[Instrumental A] (Very Fast, Mandolin, Banjo Solo)',
                    'Breakdown (Quiet)': '[Breakdown] (Half-time feel, Gentle Flute, Quiet Drums)',
                    'Instrumental B (Climactic)': '[Instrumental B] (Max Intensity, High Voice Yodeling)',
                    'Instrumental A (Repeat)': '[Instrumental A] (Repeat, Full Power)',
                    'Outro': '[Outro] (End on a powerful chord)'
                }
            },
            "NarrativeCountry": {
                desc: "Story-focused Country music, often using pedal steel and a longer structure.",
                sections: ['Intro (Pedal Steel)', 'Verse 1', 'Chorus', 'Verse 2', 'Chorus', 'Verse 3 (New Story)', 'Pedal Steel Solo', 'Outro'],
                template: {
                    'Intro (Pedal Steel)': '[Intro] (Pedal Steel Guitar, Nostalgic)',
                    'Verse 1': '[Verse 1] (Storytelling, Raspy Voice)\n<Verse 1 lyrics 6 lines>',
                    'Chorus': '[Chorus] (Medium Tempo, Backbeat)\n<Chorus lyrics 4 lines>',
                    'Verse 2': '[Verse 2] (Storytelling, Deeper)\n<Verse 2 lyrics 6 lines>',
                    'Verse 3 (New Story)': '[Verse 3] (Emotional Climax, Building)\n<Verse 3 lyrics 6 lines>',
                    'Pedal Steel Solo': '[Solo] (Pedal Steel Guitar Solo, Melancholic)',
                    'Outro': '[Outro] (Fade out, Guitar Riff)'
                }
            },
            "StandardReggae": {
                desc: "Reggae rhythm with off-beat emphasis and a dedicated dub break.",
                sections: ['Intro (Bassline)', 'Verse 1', 'Chorus', 'Verse 2', 'Chorus', 'Dub Break', 'Toasting Verse', 'Outro'],
                template: {
                    'Intro (Bassline)': '[Intro] (Off-beat, Bass Guitar, Low Energy)',
                    'Verse 1': '[Verse 1] (Medium Tempo, Smooth Vocals)\n<Verse 1 lyrics 4 lines>',
                    'Chorus': '[Chorus] (Medium Energy, Off-beat)\n<Chorus lyrics 4 lines>',
                    'Verse 2': '[Verse 2] (Storytelling, Gentle)\n<Verse 2 lyrics 4 lines>',
                    'Dub Break': '[Break] (Reverb FX, Echo Delay, Dub Mix)',
                    'Toasting Verse': '[Verse 3] (Toasting/Rapping, Dynamic)\n<Toasting lyrics 4 lines>',
                    'Outro': '[Outro] (Fade out, Echo Delay)'
                }
            }
        };

        // Global variable to store current section details
        let currentSectionDetails = {};
        
        // --- Core Functions ---

        // Function to create an HTML option element
        function createOption(value, text) {
            const option = document.createElement('option');
            option.value = value;
            option.textContent = text;
            return option;
        }

        // Function to create a combobox/select element
        function createSelect(idPrefix, sectionName, options) {
            const select = document.createElement('select');
            select.id = `${idPrefix}-${sectionName}`;
            select.name = select.id;
            select.onchange = generatePrompt; // Trigger prompt regeneration on change

            options.forEach(optionData => {
                select.appendChild(createOption(optionData.value, optionData.label));
            });

            return select;
        }
        
        // Function to create a checkbox input and its label (for instruments)
        function createInstrumentCheckbox(sectionName, category, instrument) {
            const container = document.createElement('label');
            
            // Create checkbox
            const input = document.createElement('input');
            input.type = 'checkbox';
            input.name = `instrument-${sectionName}-${category}`;
            input.value = instrument.value;
            input.id = `inst-${sectionName}-${instrument.value.replace(/\s/g, '-')}`;
            
            // Attach real-time visual and prompt generation listeners
            input.addEventListener('change', (event) => {
                // Toggle checked-label class on the parent label
                event.target.parentElement.classList.toggle('checked-label', event.target.checked);
                // Trigger prompt generation
                generatePrompt();
            });

            // Set initial state
            if (currentSectionDetails[sectionName] && 
                currentSectionDetails[sectionName].instruments && 
                currentSectionDetails[sectionName].instruments.includes(instrument.value)) {
                input.checked = true;
                container.classList.add('checked-label');
            }

            container.appendChild(input);
            container.appendChild(document.createTextNode(instrument.label)); // Text node for the instrument name
            
            return container;
        }

        // Function to generate the Instrument Multiselect Area
        function createInstrumentArea(sectionName) {
            const container = document.createElement('div');
            container.className = 'instrument-multiselect';
            
            const title = document.createElement('h4');
            title.textContent = '4. üé∏ Instrument Tags (Select All Relevant)';
            container.appendChild(title);

            // Function to generate a list of instruments for a category
            function generateInstrumentList(titleText, instruments) {
                const categoryTitle = document.createElement('p');
                categoryTitle.innerHTML = `<strong>${titleText}:</strong>`;
                container.appendChild(categoryTitle);
                
                const list = document.createElement('div');
                list.className = 'instrument-list';
                
                instruments.forEach(instrument => {
                    list.appendChild(createInstrumentCheckbox(sectionName, titleText.replace(/\s/g, ''), instrument));
                });
                container.appendChild(list);
            }
            
            generateInstrumentList('Keys/Strings/Brass', detailOptions.instrumentCategories.melodyHarmony);
            generateInstrumentList('Rhythm/Percussion', detailOptions.instrumentCategories.rhythm);
            generateInstrumentList('Special/Regional', detailOptions.instrumentCategories.specialRegion);
            generateInstrumentList('FX/Texture', detailOptions.instrumentCategories.fxTexture);

            return container;
        }

        // Main function to update the structure details section
        function updateSectionDetails(structureKey) {
            const container = document.getElementById('section-details-container');
            const desc = document.getElementById('structureDesc');
            container.innerHTML = '';
            currentSectionDetails = {}; // Reset details

            if (!structureKey) {
                desc.textContent = "Selected structure features: Please select a structure type.";
                return;
            }

            const data = structureData[structureKey];
            desc.textContent = `Selected structure features: ${data.desc}`;

            data.sections.forEach(sectionName => {
                // Initialize details for this section
                currentSectionDetails[sectionName] = {
                    tempo: '',
                    rhythmAndMood: '',
                    vocal: '',
                    instruments: []
                };

                const sectionDiv = document.createElement('div');
                sectionDiv.className = 'section-detail';
                sectionDiv.id = `detail-${sectionName.replace(/\s/g, '-')}`;

                const titleLabel = document.createElement('label');
                titleLabel.textContent = `‚ñ∂Ô∏è Section: ${sectionName}`;
                sectionDiv.appendChild(titleLabel);

                const detailRow = document.createElement('div');
                detailRow.className = 'detail-row';

                // 1. Tempo/BPM Select
                detailRow.appendChild(createSelect('tempo', sectionName, detailOptions.tempo));
                
                // 2. Rhythm/Mood Select
                detailRow.appendChild(createSelect('rhythmMood', sectionName, detailOptions.rhythmAndMood));
                
                // 3. Vocal Tone Select
                detailRow.appendChild(createSelect('vocalTone', sectionName, detailOptions.vocal));
                
                sectionDiv.appendChild(detailRow);
                
                // 4. Instrument Multiselect Area
                sectionDiv.appendChild(createInstrumentArea(sectionName));
                
                container.appendChild(sectionDiv);
            });
            
            // Trigger an initial prompt update after loading the sections
            generatePrompt();
        }


        // Function to collect data and generate the final prompt
        function generatePrompt() {
            // --- Result 1: Style of Music Tags ---
            const overallTags = [];
            
            // 1. Checkbox groups
            document.querySelectorAll('#style-selection .checkbox-group input[type="checkbox"]:checked').forEach(input => {
                overallTags.push(input.value);
            });

            // 2. Selects/Inputs
            const vocalGender = document.getElementById('overallVocalGender').value;
            if (vocalGender) overallTags.push(vocalGender);
            
            const bpmValue = document.getElementById('overallBpm').value.trim();
            if (bpmValue) overallTags.push(`BPM ${bpmValue}`);

            document.getElementById('outputStyle').value = overallTags.join(', ');


            // --- Result 2: Lyrics Template with Section Tags ---
            const structureKey = document.getElementById('structureType').value;
            let lyricsOutput = '';
            
            if (structureKey && structureData[structureKey]) {
                const data = structureData[structureKey];
                const sections = data.sections;
                const template = data.template;
                
                const finalLyricsArray = [];

                sections.forEach(sectionName => {
                    const baseTemplate = template[sectionName];
                    if (!baseTemplate) return;

                    let baseTag = baseTemplate.match(/\[(.*?)\]/)[0]; // e.g., [Verse 1]
                    let existingTags = baseTemplate.substring(baseTag.length).trim(); // e.g., (Medium Energy)

                    // Remove surrounding parenthesis if empty
                    if (existingTags.startsWith('(') && existingTags.endsWith(')')) {
                        existingTags = existingTags.substring(1, existingTags.length - 1).trim();
                    }

                    const sectionTags = [];

                    // 1. Collect Combobox tags (Tempo, Rhythm/Mood, Vocal)
                    const tempo = document.getElementById(`tempo-${sectionName}`).value;
                    const rhythmMood = document.getElementById(`rhythmMood-${sectionName}`).value;
                    const vocalTone = document.getElementById(`vocalTone-${sectionName}`).value;

                    if (tempo) sectionTags.push(tempo);
                    if (rhythmMood) sectionTags.push(rhythmMood);
                    if (vocalTone) sectionTags.push(vocalTone);

                    // 2. Collect Instrument Checkbox tags
                    const instrumentInputs = document.querySelectorAll(`input[name^="instrument-${sectionName}-"]:checked`);
                    instrumentInputs.forEach(input => {
                        sectionTags.push(input.value);
                    });
                    
                    // Combine all tags: existing tags from template + new custom tags
                    const allTags = [existingTags, ...sectionTags].filter(tag => tag.trim() !== '').join(', ');

                    // Reconstruct the line
                    const newTagString = allTags ? `(${allTags.trim()})` : '';
                    
                    // Find the split point: the first newline character
                    const splitIndex = baseTemplate.indexOf('\n');
                    
                    if (splitIndex !== -1) {
                        // If template has both tag line and placeholder lyric line
                        const lyricLine = baseTemplate.substring(splitIndex + 1);
                        finalLyricsArray.push(`${baseTag} ${newTagString}`.trim());
                        finalLyricsArray.push(lyricLine);
                    } else {
                        // If template only has a tag line (e.g., Dance Break)
                        finalLyricsArray.push(`${baseTag} ${newTagString}`.trim());
                    }
                });

                lyricsOutput = finalLyricsArray.join('\n\n');
            }

            document.getElementById('outputLyrics').value = lyricsOutput;
        }

        // D. Initial setup and listeners when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            setupCheckboxVisuals(); // [NEW] Initialize visual state for checkboxes
            
            // Add change listener to the structure dropdown (already has onchange attribute, but for completeness)
            document.getElementById('structureType').addEventListener('change', generatePrompt);

            // Add input listeners for the overall BPM input
            document.getElementById('overallBpm').addEventListener('input', generatePrompt);
            document.getElementById('overallVocalGender').addEventListener('change', generatePrompt);
            
            // Initial call to update sections/prompt (in case default structure is set)
            updateSectionDetails(document.getElementById('structureType').value);
        });

    </script>
</body>
</html>
